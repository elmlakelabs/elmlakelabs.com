---
interface Props {
  currentPath?: string;
}

const { currentPath = '/' } = Astro.props;
---

<header class="header fixed top-0 left-0 right-0 z-50 px-4 md:px-8 py-4 transition-all duration-300" style="background: linear-gradient(to bottom, var(--bg-primary), transparent);">
  <nav class="max-w-[1400px] mx-auto flex items-center justify-between gap-8">
    <a href="/" class="logo flex items-center gap-2 font-display text-xl text-[var(--text-primary)]">
      <span class="text-[var(--accent-primary)] text-2xl">◈</span>
      <span>Elm Lake Labs</span>
    </a>

    <div class="nav-links hidden md:flex gap-8">
      <a href="#solutions" class="nav-link text-sm text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors relative">
        Solutions
      </a>
      <a href="#products" class="nav-link text-sm text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors relative">
        Products
      </a>
      <a href="#software" class="nav-link text-sm text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors relative">
        Software
      </a>
      <a href="#about" class="nav-link text-sm text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors relative">
        About
      </a>
    </div>

    <a href="https://store.elmlakelabs.com" class="nav-cta hidden md:flex items-center gap-1.5 px-4 py-2 bg-[var(--bg-card)] border border-[var(--border-medium)] rounded-md text-sm text-[var(--text-primary)] hover:bg-[var(--bg-card-hover)] hover:border-[var(--accent-primary)] transition-all" target="_blank">
      <span>Shop</span>
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M7 17L17 7M17 7H7M17 7V17"/>
      </svg>
    </a>

    <button class="mobile-toggle md:hidden flex flex-col gap-1.5 p-2" aria-label="Toggle menu">
      <span class="block w-6 h-0.5 bg-[var(--text-primary)] transition-transform"></span>
      <span class="block w-6 h-0.5 bg-[var(--text-primary)] transition-transform"></span>
    </button>
  </nav>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu hidden fixed top-[72px] left-0 right-0 bg-[var(--bg-secondary)] border-b border-[var(--border-subtle)] z-40 transform -translate-y-full opacity-0 transition-all duration-300">
  <div class="flex flex-col p-8">
    <a href="#solutions" class="mobile-link py-4 text-lg text-[var(--text-secondary)] border-b border-[var(--border-subtle)] hover:text-[var(--text-primary)]">Solutions</a>
    <a href="#products" class="mobile-link py-4 text-lg text-[var(--text-secondary)] border-b border-[var(--border-subtle)] hover:text-[var(--text-primary)]">Products</a>
    <a href="#software" class="mobile-link py-4 text-lg text-[var(--text-secondary)] border-b border-[var(--border-subtle)] hover:text-[var(--text-primary)]">Software</a>
    <a href="#about" class="mobile-link py-4 text-lg text-[var(--text-secondary)] border-b border-[var(--border-subtle)] hover:text-[var(--text-primary)]">About</a>
    <a href="https://store.elmlakelabs.com" class="mt-4 text-[var(--accent-primary)]" target="_blank">Shop →</a>
  </div>
</div>

<style>
  .header.scrolled {
    background: rgba(10, 15, 13, 0.95) !important;
    backdrop-filter: blur(10px);
  }

  .nav-link::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 0;
    height: 1px;
    background: var(--accent-primary);
    transition: width 0.25s ease;
  }

  .nav-link:hover::after {
    width: 100%;
  }

  .mobile-menu.active {
    display: block;
    transform: translateY(0);
    opacity: 1;
  }
</style>

<script>
  const toggle = document.querySelector('.mobile-toggle');
  const menu = document.querySelector('.mobile-menu');
  const links = menu?.querySelectorAll('a');
  const spans = toggle?.querySelectorAll('span');

  toggle?.addEventListener('click', () => {
    const isOpen = menu?.classList.contains('active');

    if (isOpen) {
      menu?.classList.remove('active');
      document.body.style.overflow = '';
      if (spans) {
        spans[0].style.transform = '';
        spans[1].style.transform = '';
      }
    } else {
      menu?.classList.add('active');
      document.body.style.overflow = 'hidden';
      if (spans) {
        spans[0].style.transform = 'rotate(45deg) translate(4px, 4px)';
        spans[1].style.transform = 'rotate(-45deg) translate(1px, -1px)';
      }
    }
  });

  links?.forEach(link => {
    link.addEventListener('click', () => {
      menu?.classList.remove('active');
      document.body.style.overflow = '';
      if (spans) {
        spans[0].style.transform = '';
        spans[1].style.transform = '';
      }
    });
  });
</script>
